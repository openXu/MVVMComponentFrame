apply plugin: 'com.android.library'

android {
    rootProject.ext.setAndroidConfig android

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            buildConfigField "String", "appId", rootProject.ext.appId
            buildConfigField "String", "appType", rootProject.ext.appType
            buildConfigField "String", "appFileRoot", rootProject.ext.appFileRoot
            buildConfigField "String", "applicationInitClass", rootProject.ext.applicationInitClass
            buildConfigField "String", "baseUrl", rootProject.ext.baseUrl
        }
        debug {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            buildConfigField "String", "appId", rootProject.ext.appId
            buildConfigField "String", "appType", rootProject.ext.appType
            buildConfigField "String", "appFileRoot", rootProject.ext.appFileRoot
            buildConfigField "String", "applicationInitClass", rootProject.ext.applicationInitClass
            buildConfigField "String", "baseUrl", rootProject.ext.baseUrl
        }
    }
}

dependencies {
    api fileTree(dir: 'libs', include: ['*.jar'])
    //api 'com.android.support:appcompat-v7:28.0.0'
    /**AndroidX*/
    api rootProject.ext.libdependencies["appcompat"]
    api rootProject.ext.libdependencies["viewmodel"]
    api rootProject.ext.libdependencies["livedata"]
    api rootProject.ext.libdependencies["lifecycle"]
    api rootProject.ext.libdependencies["multidex"]
    api rootProject.ext.libdependencies["constraintlayout"]
    api rootProject.ext.libdependencies["recyclerview"]
    api rootProject.ext.libdependencies["recyclerview-selection"]
    /**三方库*/
    //SmartRefreshLayout 刷新1.1.0 androidx 版本
    api rootProject.ext.libdependencies["SmartRefreshHeader"]
    api(rootProject.ext.libdependencies["SmartRefreshLayout"]) {
        exclude group: 'androidx.lifecycle', module: 'lifecycle-runtime'
    }
    //okhttp+retrofit
    api rootProject.ext.libdependencies["logging-interceptor"]
    api rootProject.ext.libdependencies["retrofit"]
    api rootProject.ext.libdependencies["adapter-rxjava"]
    api rootProject.ext.libdependencies["converter"]
    api rootProject.ext.libdependencies["rxjava"]
    api rootProject.ext.libdependencies["rxandroid"]
    api rootProject.ext.libdependencies["autodispose"]
    //阿里路由框架
    api rootProject.ext.libdependencies["arouter-api"]
    //每个组件中依赖阿里路由编译框架
    annotationProcessor rootProject.ext.libdependencies["arouter-compiler"]
    //二维码
    api rootProject.ext.libdependencies["zxing"]
    api rootProject.ext.libdependencies["gson"]
    api 'com.alibaba:fastjson:1.1.72.android'
    api rootProject.ext.libdependencies["glide"]
    api rootProject.ext.libdependencies["rxbus"]
    //权限 AndPermission对国内厂商适配比较好
    api rootProject.ext.libdependencies["AndPermission"]
}

//强制指定依赖版本，避免冲突
configurations.all {
    resolutionStrategy.eachDependency { details ->
        def requested = details.requested
        if (requested.group == 'androidx.lifecycle') {
            if (requested.name.startsWith("lifecycle-runtime")) {
                details.useVersion rootProject.ext.lifecycle_version
            }
        }else if(requested.group == 'io.reactivex.rxjava3'){
            details.useVersion rootProject.ext.rxjava_version
//            'rxjava'              : "io.reactivex.rxjava3:rxjava:$rxjava_version",
//            'rxandroid'           : "io.reactivex.rxjava3:rxandroid:$rxjava_version",
        }
    }
}